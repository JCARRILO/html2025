<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../CSS/common.css">
  <link rel="stylesheet" href="styles.css">
<title>Clase 10 ‚Äî ARIA en la pr√°ctica</title>
  
</head>
<body>
  <header class="hero site">
    <div class="wrap">
      <h1>Clase 10 ¬∑ ARIA en la pr√°ctica</h1>
      <p class="sub">Regla de oro: usa primero HTML sem√°ntico; aplica ARIA solo cuando sea necesario para expresar nombre, rol y estado.</p>
    </div>
  </header>

  <main class="wrap">
    <aside class="lesson-aside" role="complementary" aria-labelledby="aside-title-clase-10">
      <h2 id="aside-title-clase-10">En esta clase</h2>
      <ul>
        <li><span class="dot dot-nombre" aria-hidden="true"></span><a href="#k-nombre">Nombre accesible</a></li>
        <li><span class="dot dot-acc" aria-hidden="true"></span><a href="#acc-faq">Acorde√≥n accesible</a></li>
        <li><span class="dot dot-tabs" aria-hidden="true"></span><a href="#demo-tabs">Tabs</a></li>
        <li><span class="dot dot-dialog" aria-hidden="true"></span><a href="#dialog">Di√°logo modal</a></li>
        <li><span class="dot dot-live" aria-hidden="true"></span><a href="#live-polite">Regiones en vivo</a></li>
      </ul>
    </aside>
    <!-- 1) Nombres accesibles -->
    <section class="section" id="k-nombre" tabindex="-1">
      <div class="card">
        <h2 class="title">1) Nombre accesible</h2>
        <p class="muted">Comparativa entre <code>aria-label</code>, <code>aria-labelledby</code> y <code>aria-describedby</code>.</p>
        <div class="grid">
          <div>
            <button aria-label="Abrir carrito" class="btn">üõí</button>
            <p class="muted">Bot√≥n con <code>aria-label</code>.</p>
          </div>
          <div>
            <span id="lbl-buscar">Buscar productos</span>
            <input type="search" aria-labelledby="lbl-buscar" placeholder="Ej. Teclado">
            <p class="muted">Campo con <code>aria-labelledby</code>.</p>
          </div>
          <div>
            <label for="email">Email</label>
            <p id="help-email" class="muted">Usa tu correo de registro.</p>
            <input id="email" type="email" aria-describedby="help-email" placeholder="tu@correo.com">
            <p class="muted">Campo con <code>aria-describedby</code> (texto de ayuda).</p>
          </div>
        </div>
      </div>
    </section>

    <!-- 2) Accordion accesible -->
    <section class="section">
      <div class="card acc" id="acc-faq">
        <h2 class="title">2) Acorde√≥n accesible</h2>
        <p class="muted">Gestiona <code>aria-expanded</code>, <code>aria-controls</code> y <code>aria-labelledby</code>. Teclado: ‚Üë/‚Üì para moverse; Enter/Espacio para abrir.</p>
        <div>
          <h3 class="visually-hidden" id="acc-title">Preguntas frecuentes</h3>
          <div>
            <button class="acc-btn" aria-expanded="false" aria-controls="p1" id="h1">¬øQu√© es ARIA?</button>
            <div class="panel hidden" id="p1" role="region" aria-labelledby="h1">
              Mejora la accesibilidad exponiendo nombre, rol y estado cuando HTML por s√≠ solo no alcanza.
            </div>
          </div>
          <div>
            <button class="acc-btn" aria-expanded="false" aria-controls="p2" id="h2">¬øCu√°ndo usarlo?</button>
            <div class="panel hidden" id="p2" role="region" aria-labelledby="h2">
              Despu√©s de usar la mejor etiqueta sem√°ntica disponible. ARIA no cambia el comportamiento por s√≠ mismo.
            </div>
          </div>
          <div>
            <button class="acc-btn" aria-expanded="false" aria-controls="p3" id="h3">¬øQu√© evitar?</button>
            <div class="panel hidden" id="p3" role="region" aria-labelledby="h3">
              No ocultes contenido enfocable con <code>aria-hidden</code>; sincroniza siempre los estados ARIA con el DOM visual.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 3) Tabs (pesta√±as) -->
    <section class="section">
      <div class="card tabs" id="demo-tabs">
        <h2 class="title">3) Pesta√±as (Tabs)</h2>
        <p class="muted">Roles: <code>tablist</code>, <code>tab</code>, <code>tabpanel</code>. Teclado: ‚Üê/‚Üí, Home/End, Enter/Espacio.</p>
        <div role="tablist" aria-label="Secciones de contenido" class="tablist">
          <button role="tab" id="t-1" class="tabbtn" aria-selected="true" aria-controls="tp-1" tabindex="0">General</button>
          <button role="tab" id="t-2" class="tabbtn" aria-selected="false" aria-controls="tp-2" tabindex="-1">Detalles</button>
          <button role="tab" id="t-3" class="tabbtn" aria-selected="false" aria-controls="tp-3" tabindex="-1">Accesibilidad</button>
        </div>
        <div id="tp-1" role="tabpanel" tabindex="0" aria-labelledby="t-1" class="tabpanel">Contenido general.</div>
        <div id="tp-2" role="tabpanel" tabindex="0" aria-labelledby="t-2" class="tabpanel hidden">Informaci√≥n de detalles.</div>
        <div id="tp-3" role="tabpanel" tabindex="0" aria-labelledby="t-3" class="tabpanel hidden">Buenas pr√°cticas de accesibilidad.</div>
      </div>
    </section>

    <!-- 4) Di√°logo modal accesible -->
    <section class="section">
      <div class="card">
        <h2 class="title">4) Di√°logo modal</h2>
        <p class="muted">Usa <code>role="dialog"</code>, <code>aria-modal="true"</code>, nombre/descripci√≥n y gesti√≥n de foco. Tecla Esc para cerrar.</p>
        <button id="open-dialog" class="btn primary">Abrir di√°logo</button>
        <div class="backdrop" id="backdrop" aria-hidden="true">
          <div role="dialog" aria-modal="true" aria-labelledby="dlg-title" aria-describedby="dlg-desc" class="dialog" id="dialog">
            <header class="site">
              <h3 id="dlg-title" style="margin:0">Confirmar acci√≥n</h3>
              <button class="btn" id="close-dialog" aria-label="Cerrar">‚úï</button>
            </header>
            <main id="dlg-desc">
              ¬øDeseas continuar con la operaci√≥n? Esta acci√≥n es reversible.
            </main>
            <footer class="site">
              <button class="btn" id="cancel-dialog">Cancelar</button>
              <button class="btn primary" id="ok-dialog">Aceptar</button>
            </footer>
          </div>
        </div>
      </div>
    </section>

    <!-- 5) Regiones en vivo -->
    <section class="section">
      <div class="card">
        <h2 class="title">5) Regiones en vivo</h2>
        <p class="muted">Anuncia cambios din√°micos con <code>aria-live</code>. <em>polite</em> espera; <em>assertive</em> interrumpe.</p>
        <div class="grid">
          <div>
            <div id="live-polite" aria-live="polite" class="tabpanel" style="min-height:42px">(anuncios suaves)</div>
            <button class="btn" id="btn-polite">Anunciar (polite)</button>
          </div>
          <div>
            <div id="live-assertive" aria-live="assertive" class="tabpanel" style="min-height:42px">(anuncios urgentes)</div>
            <button class="btn" id="btn-assertive">Anunciar (assertive)</button>
          </div>
        </div>
      </div>
    </section>

    <!-- 6) Formularios: errores y estado -->
    <section class="section">
      <div class="card">
        <h2 class="title">6) Formularios con ARIA</h2>
        <p class="muted">Demostraci√≥n de <code>aria-invalid</code>, <code>aria-required</code>, <code>aria-errormessage</code> y enfoque del error.</p>
        <form id="demo-form" novalidate>
          <div class="field">
            <label for="f-nombre">Nombre</label>
            <input id="f-nombre" name="nombre" required aria-required="true" aria-describedby="dsc-nombre" />
            <div id="dsc-nombre" class="muted">Tu nombre completo.</div>
            <div id="err-nombre" class="error visually-hidden" role="alert">El nombre es obligatorio.</div>
          </div>
          <div class="field">
            <label for="f-edad">Edad</label>
            <input id="f-edad" name="edad" inputmode="numeric" pattern="^[0-9]{1,3}$" aria-describedby="dsc-edad" />
            <div id="dsc-edad" class="muted">Introduce solo n√∫meros (0‚Äì120).</div>
            <div id="err-edad" class="error visually-hidden" role="alert">La edad debe ser un n√∫mero v√°lido.</div>
          </div>
          <button class="btn primary" type="submit">Enviar</button>
        </form>
      </div>
    </section>
  </main>

  <script>
    // Utilidad: mover foco dentro del modal
    function trapFocus(container){
      const focusable = container.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])');
      const first = focusable[0]; const last = focusable[focusable.length-1];
      function onKey(e){
        if(e.key !== 'Tab') return;
        if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
        else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
      }
      container.addEventListener('keydown', onKey);
      return ()=> container.removeEventListener('keydown', onKey);
    }

    // Accordion
    (function(){
      const root = document.getElementById('acc-faq');
      if(!root) return;
      const btns = root.querySelectorAll('.acc-btn');
      btns.forEach((b,i)=>{
        b.addEventListener('click',()=>toggle(b));
        b.addEventListener('keydown', e=>{
          const k=e.key; if(k==='ArrowDown'){ e.preventDefault(); btns[Math.min(i+1, btns.length-1)].focus(); }
          if(k==='ArrowUp'){ e.preventDefault(); btns[Math.max(i-1, 0)].focus(); }
          if(k==='Home'){ e.preventDefault(); btns[0].focus(); }
          if(k==='End'){ e.preventDefault(); btns[btns.length-1].focus(); }
          if(k===' '||k==='Enter'){ e.preventDefault(); toggle(b); }
        });
      });
      function toggle(btn){
        const id = btn.getAttribute('aria-controls');
        const panel = document.getElementById(id);
        const exp = btn.getAttribute('aria-expanded')==='true';
        btn.setAttribute('aria-expanded', String(!exp));
        panel.classList.toggle('hidden', exp);
      }
    })();

    // Tabs
    (function(){
      const root = document.getElementById('demo-tabs');
      if(!root) return;
      const tabs = Array.from(root.querySelectorAll('[role="tab"]'));
      const panels = tabs.map(t=> document.getElementById(t.getAttribute('aria-controls')));
      function setActive(index){
        tabs.forEach((t,i)=>{
          const sel = i===index; t.setAttribute('aria-selected', String(sel)); t.tabIndex = sel?0:-1;
          panels[i].classList.toggle('hidden', !sel);
        });
        tabs[index].focus();
      }
      tabs.forEach((t,i)=>{
        t.addEventListener('click', ()=> setActive(i));
        t.addEventListener('keydown', e=>{
          const keys={ArrowRight:1, ArrowLeft:-1, Home:'home', End:'end', ' ':0, Enter:0};
          if(!(e.key in keys)) return;
          e.preventDefault();
          if(keys[e.key]==='home') return setActive(0);
          if(keys[e.key]==='end') return setActive(tabs.length-1);
          const next = (i + (keys[e.key]||0) + tabs.length) % tabs.length;
          setActive(next);
        });
      });
    })();

    // Dialog modal
    (function(){
      const open = document.getElementById('open-dialog');
      const backdrop = document.getElementById('backdrop');
      const dialog = document.getElementById('dialog');
      const btnClose = document.getElementById('close-dialog');
      const btnCancel = document.getElementById('cancel-dialog');
      const btnOk = document.getElementById('ok-dialog');
      if(!open || !dialog) return;
      let untrap = null; let prevFocus = null;
      function show(){
        prevFocus = document.activeElement; backdrop.classList.add('active'); backdrop.removeAttribute('aria-hidden');
        untrap = trapFocus(dialog); btnOk.focus();
        document.addEventListener('keydown', onEsc);
      }
      function hide(){
        backdrop.classList.remove('active'); backdrop.setAttribute('aria-hidden','true');
        if(untrap) untrap(); document.removeEventListener('keydown', onEsc);
        if(prevFocus && prevFocus.focus) prevFocus.focus();
      }
      function onEsc(e){ if(e.key==='Escape') hide(); }
      open.addEventListener('click', show);
      btnClose.addEventListener('click', hide);
      btnCancel.addEventListener('click', hide);
      btnOk.addEventListener('click', hide);
      backdrop.addEventListener('click', e=>{ if(e.target===backdrop) hide(); });
    })();

    // Live regions
    (function(){
      const polite = document.getElementById('live-polite');
      const assertive = document.getElementById('live-assertive');
      document.getElementById('btn-polite')?.addEventListener('click', ()=>{
        polite.textContent = 'Actualizado: ' + new Date().toLocaleTimeString();
      });
      document.getElementById('btn-assertive')?.addEventListener('click', ()=>{
        assertive.textContent = '¬°Atenci√≥n! ' + new Date().toLocaleTimeString();
      });
    })();

    // Form validation (aria-invalid / aria-errormessage)
    (function(){
      const form = document.getElementById('demo-form');
      if(!form) return;
      form.addEventListener('submit', e=>{
        e.preventDefault();
        const nombre = document.getElementById('f-nombre');
        const edad = document.getElementById('f-edad');
        let firstError = null;
        function setErr(input, errId, cond){
          const err = document.getElementById(errId);
          const has = Boolean(cond);
          input.setAttribute('aria-invalid', has? 'true':'false');
          input.setAttribute('aria-errormessage', errId);
          err.classList.toggle('visually-hidden', !has);
          if(has && !firstError) firstError = input;
        }
        setErr(nombre, 'err-nombre', !nombre.value.trim());
        const edadVal = edad.value.trim();
        const edadOk = edadVal==='' || /^[0-9]{1,3}$/.test(edadVal);
        setErr(edad, 'err-edad', !edadOk);
        (firstError || form.querySelector('button[type="submit"]')).focus();
      });
    })();
  </script>
  <script src='../../CSS/aside-scrollspy.js'></script>
</body>
</html>





